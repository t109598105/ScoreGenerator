!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ScoreGenerator={})}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=i(t);if(e){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){c=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw i}}}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h={exports:{}};!function(t,n){var r="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",u="[object Boolean]",c="[object Date]",a="[object Function]",f="[object GeneratorFunction]",s="[object Map]",l="[object Number]",h="[object Object]",y="[object Promise]",v="[object RegExp]",d="[object Set]",b="[object String]",_="[object Symbol]",g="[object WeakMap]",j="[object ArrayBuffer]",w="[object DataView]",m="[object Float32Array]",O="[object Float64Array]",k="[object Int8Array]",x="[object Int16Array]",S="[object Int32Array]",A="[object Uint8Array]",P="[object Uint8ClampedArray]",E="[object Uint16Array]",I="[object Uint32Array]",D=/\w*$/,R=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,L={};L[i]=L["[object Array]"]=L[j]=L[w]=L[u]=L[c]=L[m]=L[O]=L[k]=L[x]=L[S]=L[s]=L[l]=L[h]=L[v]=L[d]=L[b]=L[_]=L[A]=L[P]=L[E]=L[I]=!0,L["[object Error]"]=L[a]=L[g]=!1;var M="object"==e(p)&&p&&p.Object===Object&&p,U="object"==("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,X=M||U||Function("return this")(),C=n&&!n.nodeType&&n,F=C&&t&&!t.nodeType&&t,$=F&&F.exports===C;function B(t,e){return t.set(e[0],e[1]),t}function W(t,e){return t.add(e),t}function Y(t,e,n,r){var o=-1,i=t?t.length:0;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function G(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function N(t,e){return function(n){return t(e(n))}}function z(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var V,q=Array.prototype,J=Function.prototype,K=Object.prototype,Q=X["__core-js_shared__"],Z=(V=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",tt=J.toString,et=K.hasOwnProperty,nt=K.toString,rt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=$?X.Buffer:void 0,it=X.Symbol,ut=X.Uint8Array,ct=N(Object.getPrototypeOf,Object),at=Object.create,ft=K.propertyIsEnumerable,st=q.splice,lt=Object.getOwnPropertySymbols,pt=ot?ot.isBuffer:void 0,ht=N(Object.keys,Object),yt=Ft(X,"DataView"),vt=Ft(X,"Map"),dt=Ft(X,"Promise"),bt=Ft(X,"Set"),_t=Ft(X,"WeakMap"),gt=Ft(Object,"create"),jt=Gt(yt),wt=Gt(vt),mt=Gt(dt),Ot=Gt(bt),kt=Gt(_t),xt=it?it.prototype:void 0,St=xt?xt.valueOf:void 0;function At(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Pt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Et(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function It(t){this.__data__=new Pt(t)}function Dt(t,n){var r=Nt(t)||function(t){return function(t){return function(t){return!!t&&"object"==e(t)}(t)&&zt(t)}(t)&&et.call(t,"callee")&&(!ft.call(t,"callee")||nt.call(t)==i)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],o=r.length,u=!!o;for(var c in t)!n&&!et.call(t,c)||u&&("length"==c||Wt(c,o))||r.push(c);return r}function Rt(t,e,n){var r=t[e];et.call(t,e)&&Ht(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function Tt(t,e){for(var n=t.length;n--;)if(Ht(t[n][0],e))return n;return-1}function Lt(t,e,n,r,o,p,y){var g;if(r&&(g=p?r(t,o,p,y):r(t)),void 0!==g)return g;if(!Jt(t))return t;var R=Nt(t);if(R){if(g=function(t){var e=t.length,n=t.constructor(e);e&&"string"==typeof t[0]&&et.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!e)return function(t,e){var n=-1,r=t.length;e||(e=Array(r));for(;++n<r;)e[n]=t[n];return e}(t,g)}else{var T=Bt(t),M=T==a||T==f;if(Vt(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(T==h||T==i||M&&!p){if(G(t))return p?t:{};if(g=function(t){return"function"!=typeof t.constructor||Yt(t)?{}:(e=ct(t),Jt(e)?at(e):{});var e}(M?{}:t),!e)return function(t,e){return Xt(t,$t(t),e)}(t,function(t,e){return t&&Xt(e,Kt(e),t)}(g,t))}else{if(!L[T])return p?t:{};g=function(t,e,n,r){var o=t.constructor;switch(e){case j:return Ut(t);case u:case c:return new o(+t);case w:return function(t,e){var n=e?Ut(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,r);case m:case O:case k:case x:case S:case A:case P:case E:case I:return function(t,e){var n=e?Ut(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,r);case s:return function(t,e,n){return Y(e?n(H(t),!0):H(t),B,new t.constructor)}(t,r,n);case l:case b:return new o(t);case v:return function(t){var e=new t.constructor(t.source,D.exec(t));return e.lastIndex=t.lastIndex,e}(t);case d:return function(t,e,n){return Y(e?n(z(t),!0):z(t),W,new t.constructor)}(t,r,n);case _:return i=t,St?Object(St.call(i)):{}}var i}(t,T,Lt,e)}}y||(y=new It);var U=y.get(t);if(U)return U;if(y.set(t,g),!R)var X=n?function(t){return function(t,e,n){var r=e(t);return Nt(t)?r:function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}(r,n(t))}(t,Kt,$t)}(t):Kt(t);return function(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n,t););}(X||t,(function(o,i){X&&(o=t[i=o]),Rt(g,i,Lt(o,e,n,r,i,t,y))})),g}function Mt(t){return!(!Jt(t)||(e=t,Z&&Z in e))&&(qt(t)||G(t)?rt:R).test(Gt(t));var e}function Ut(t){var e=new t.constructor(t.byteLength);return new ut(e).set(new ut(t)),e}function Xt(t,e,n,r){n||(n={});for(var o=-1,i=e.length;++o<i;){var u=e[o],c=r?r(n[u],t[u],u,n,t):void 0;Rt(n,u,void 0===c?t[u]:c)}return n}function Ct(t,n){var r,o,i=t.__data__;return("string"==(o=e(r=n))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==r:null===r)?i["string"==typeof n?"string":"hash"]:i.map}function Ft(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Mt(n)?n:void 0}At.prototype.clear=function(){this.__data__=gt?gt(null):{}},At.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},At.prototype.get=function(t){var e=this.__data__;if(gt){var n=e[t];return n===r?void 0:n}return et.call(e,t)?e[t]:void 0},At.prototype.has=function(t){var e=this.__data__;return gt?void 0!==e[t]:et.call(e,t)},At.prototype.set=function(t,e){return this.__data__[t]=gt&&void 0===e?r:e,this},Pt.prototype.clear=function(){this.__data__=[]},Pt.prototype.delete=function(t){var e=this.__data__,n=Tt(e,t);return!(n<0)&&(n==e.length-1?e.pop():st.call(e,n,1),!0)},Pt.prototype.get=function(t){var e=this.__data__,n=Tt(e,t);return n<0?void 0:e[n][1]},Pt.prototype.has=function(t){return Tt(this.__data__,t)>-1},Pt.prototype.set=function(t,e){var n=this.__data__,r=Tt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Et.prototype.clear=function(){this.__data__={hash:new At,map:new(vt||Pt),string:new At}},Et.prototype.delete=function(t){return Ct(this,t).delete(t)},Et.prototype.get=function(t){return Ct(this,t).get(t)},Et.prototype.has=function(t){return Ct(this,t).has(t)},Et.prototype.set=function(t,e){return Ct(this,t).set(t,e),this},It.prototype.clear=function(){this.__data__=new Pt},It.prototype.delete=function(t){return this.__data__.delete(t)},It.prototype.get=function(t){return this.__data__.get(t)},It.prototype.has=function(t){return this.__data__.has(t)},It.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Pt){var r=n.__data__;if(!vt||r.length<199)return r.push([t,e]),this;n=this.__data__=new Et(r)}return n.set(t,e),this};var $t=lt?N(lt,Object):function(){return[]},Bt=function(t){return nt.call(t)};function Wt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||T.test(t))&&t>-1&&t%1==0&&t<e}function Yt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||K)}function Gt(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ht(t,e){return t===e||t!=t&&e!=e}(yt&&Bt(new yt(new ArrayBuffer(1)))!=w||vt&&Bt(new vt)!=s||dt&&Bt(dt.resolve())!=y||bt&&Bt(new bt)!=d||_t&&Bt(new _t)!=g)&&(Bt=function(t){var e=nt.call(t),n=e==h?t.constructor:void 0,r=n?Gt(n):void 0;if(r)switch(r){case jt:return w;case wt:return s;case mt:return y;case Ot:return d;case kt:return g}return e});var Nt=Array.isArray;function zt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}(t.length)&&!qt(t)}var Vt=pt||function(){return!1};function qt(t){var e=Jt(t)?nt.call(t):"";return e==a||e==f}function Jt(t){var n=e(t);return!!t&&("object"==n||"function"==n)}function Kt(t){return zt(t)?Dt(t):function(t){if(!Yt(t))return ht(t);var e=[];for(var n in Object(t))et.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Lt(t,!0,!0)}}(h,h.exports);var y,v,d,b,_=h.exports,g=(y=new WeakMap,v=function(t,e){var n=y.get(t);return void 0===n?void 0:n[e]},d=function(t,e,n){var r=y.get(t);if(void 0===r){var o={};return o[e]=n,void y.set(t,o)}r[e]=n,y.set(t,r)},b="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.2/xlsx.full.min.js",function(){function t(e){n(this,t),d(this,"fileID",e),d(this,"corsProxy",null),d(this,"buffer",null),d(this,"workbook",null)}return o(t,[{key:"installLibrary",value:function(t,e){var n;(n=b,new Promise((function(t,e){var r=document.createElement("script");r.src=n,document.body.appendChild(r),r.addEventListener("load",(function(){t()})),r.addEventListener("error",(function(){e()}))}))).then((function(){"function"==typeof t&&t()}),(function(){"function"==typeof e&&e()}))}},{key:"downloadSheet",value:function(t,e){var n=this;(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="https://docs.google.com/spreadsheets/d/".concat(t,"/export/edit?format=xlsx"),r="string"!=typeof e?n:e+n;return new Promise((function(t,e){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onload=function(){return t({buffer:function(){return n.response},contentDisposition:function(){return n.getResponseHeader("Content-Disposition")}})},n.onerror=function(){return e(null)},n.open("GET",r),n.send()}))})(v(this,"fileID"),v(this,"corsProxy")).then((function(e){d(n,"buffer",e.buffer()),d(n,"content-disposition",e.contentDisposition()),"function"==typeof t&&t()}),(function(){"function"==typeof e&&e()}))}},{key:"mkSheet",value:function(){var t=v(this,"buffer");if(null===t)return null;var e=XLSX.read(new Uint8Array(t),{type:"array"});return d(this,"workbook",e),!0}},{key:"fileID",get:function(){return v(this,"fileID")}},{key:"contentDisposition",get:function(){return v(this,"content-disposition")}},{key:"corsProxy",set:function(t){d(this,"corsProxy",t)}},{key:"workbook",get:function(){return _(v(this,"workbook"))}},{key:"libInstalled",get:function(){return"undefined"!=typeof XLSX&&"string"==typeof XLSX.version}},{key:"xlsxLib",get:function(){return b},set:function(t){b=t}}]),t}()),j=function(){var t=new WeakMap,e=function(e,n){var r=t.get(e);return void 0===r?void 0:r[n]},r=function(e,n,r){var o=t.get(e);if(void 0===o){var i={};return i[n]=r,void t.set(e,i)}o[n]=r,t.set(e,o)},i=function(t){return{dataURI:function(){return"data:text/csv,"+encodeURIComponent(t)},string:function(){return t},blob:function(){return new Blob([t],{type:"text/csv"})},download:function(t){var e=document.createElement("a");e.download=t+".csv",e.href=URL.createObjectURL(this.blob()),e.click()}}};return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t);var a=f(s);function s(t){var e;return n(this,s),e=a.call(this,t),r(c(e),"result",null),r(c(e),"hw-count",0),r(c(e),"semester","spring"),r(c(e),"startYear",(new Date).getFullYear()),e}return o(s,[{key:"parseXLSX",value:function(){var t=this.workbook;if(null===t)return console.error("The Workbook has not initalized");var e={};t.SheetNames.forEach((function(n){var r=XLSX.utils.sheet_to_row_object_array(t.Sheets[n]);r.length>0&&(e[n]=r)}));var n=void 0!==e["研究所"]?e["研究所"].sort((function(t,e){return+t["學號"]-+e["學號"]})):[],o=void 0!==e["大學部"]?e["大學部"].sort((function(t,e){return+t["學號"]-+e["學號"]})):[],i=n.concat(o);r(this,"result",i)}},{key:"exportAttendanceSheet",value:function(){var t,n=e(this,"result"),r=e(this,"semester"),o=e(this,"startYear"),u=[],c=function(){for(var t=[],e=n[0],i=0,u=Object.keys(e);i<u.length;i++){var c=u[i].split("/");if(void 0===c.find((function(t){return 0==t.length||isNaN(+t)}))){var a=new Date,f=+c[0],s=+c[1],l="spring"==r?o:f<9?o+1:o;a.setFullYear(l),a.setMonth(f-1),a.setDate(s),t.push(a)}}return t.sort((function(t,e){return t.getTime()-e.getTime()})).map((function(t){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t.getMonth()+1+"/"+t.getDate(),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate())}))}(),a="學號,姓名,",f=l(c);try{for(f.s();!(t=f.n()).done;){var s=t.value;a=a+s[Object.keys(s)[0]]+","}}catch(t){f.e(t)}finally{f.f()}a=a.substring(0,a.length-1);for(var p=function(t){var e=n[t],r="".concat(e["學號"],",").concat(e["姓名"],",");c.forEach((function(t){var n=Object.keys(t)[0];r=r+e[n]+","})),u.push(r.substring(0,r.length-1))},h=0;h<n.length;h++)p(h);var y=a+"\n"+u.join("\n");return i(y+"\n")}},{key:"exportScore",value:function(){var t,n=e(this,"result"),r=e(this,"hw-count"),o=new Array(r).fill(1).map((function(t,e){for(var n=(t+e).toString();n.length<2;)n="0"+n;return"HW"+n})).join(","),u="學號,姓名,github,".concat(o),c=[],a=l(n);try{for(a.s();!(t=a.n()).done;){for(var f=t.value,s="".concat(f["學號"],",").concat(f["姓名"],",").concat(f.GitHub,","),p=1;p<=r;p++){for(var h=p.toString();h.length<2;)h="0"+h;void 0!==f[(h="HW"+h)+"分數"]?s=s+f[h+"分數"].trim()+",":s+=","}c.push(s.substring(0,s.length-1))}}catch(t){a.e(t)}finally{a.f()}var y=u+"\n"+c.join("\n");return i(y+"\n")}},{key:"hwCount",set:function(t){r(this,"hw-count",t)}},{key:"semester",set:function(t){if(-1==["spring","fall"].indexOf(t))return console.error('Semester must be "spring" or "fall"');r(this,"semester",t)}},{key:"startYear",set:function(t){r(this,"startYear",t)}}]),s}(g)}();t.CSVGenerator=j,t.SheetParser=g,Object.defineProperty(t,"__esModule",{value:!0})}));
