!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(r="undefined"!=typeof globalThis?globalThis:r||self).AppleScoreGenerator=e()}(this,(function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(e)}var e,t,n,o;Object.keys||(Object.keys=(e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),o=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if("object"!==r(i)&&"function"!=typeof i||null===i)throw new TypeError("Object.keys called on non-object");var a=[];for(var f in i)e.call(i,f)&&a.push(f);if(t)for(var c=0;c<o;c++)e.call(i,n[c])&&a.push(n[c]);return a})),Array.prototype.filter||(Array.prototype.filter=function(r){if(null==this)throw new TypeError;var e=Object(this),t=e.length>>>0;if("function"!=typeof r)throw new TypeError;for(var n=[],o=arguments[1],i=0;i<t;i++)if(i in e){var a=e[i];r.call(o,a,i,e)&&n.push(a)}return n}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.forEach||(Array.prototype.forEach=function(r){if(null==this)throw new TypeError;var e=Object(this),t=e.length>>>0;if("function"!=typeof r)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,o=0;o<t;o++)o in e&&r.call(n,e[o],o,e)}),Array.prototype.map||(Array.prototype.map=function(r,e){var t,n,o;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),a=i.length>>>0;if("function"!=typeof r)throw new TypeError(r+" is not a function");for(e&&(t=e),n=new Array(a),o=0;o<a;){var f,c;o in i&&(f=i[o],c=r.call(t,f,o,i),n[o]=c),o++}return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(r,e){if(null==this)throw new TypeError('"this" is null or not defined');var t=this.length>>>0;for(e=+e||0,Math.abs(e)===1/0&&(e=0),e<0&&(e+=t)<0&&(e=0);e<t;e++)if(this[e]===r)return e;return-1}),Array.isArray||(Array.isArray=function(r){return"[object Array]"===Object.prototype.toString.call(r)}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(r,e){r=0|r||0;var t=this.byteLength;if(r<0&&(r+=t),(e=void 0===e?t:0|e)<0&&(e+=t),0===t||r>=t||r>=e)return new ArrayBuffer(0);var n=Math.min(t-r,e-r),o=new ArrayBuffer(n);return new Uint8Array(o).set(new Uint8Array(this,r,n)),o}),function(){var r="undefined"!=typeof exports?exports:"undefined"!=typeof self?self:$.global,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function t(r){this.message=r}t.prototype=new Error,t.prototype.name="InvalidCharacterError",r.btoa||(r.btoa=function(r){for(var n,o,i=String(r),a=0,f=e,c="";i.charAt(0|a)||(f="=",a%1);c+=f.charAt(63&n>>8-a%1*8)){if((o=i.charCodeAt(a+=3/4))>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|o}return c}),r.atob||(r.atob=function(r){var n=String(r).replace(/[=]+$/,"");if(n.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,a=0,f=0,c="";i=n.charAt(f++);~i&&(o=a%4?64*o+i:i,a++%4)?c+=String.fromCharCode(255&o>>(-2*a&6)):0)i=e.indexOf(i);return c})}(),Date.prototype.toISOString||function(){function r(r){return r<10?"0"+r:r}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+r(this.getUTCMonth()+1)+"-"+r(this.getUTCDate())+"T"+r(this.getUTCHours())+":"+r(this.getUTCMinutes())+":"+r(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}();function i(r,e){for(var t,n={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=r.length;++i)for(var a=0;a!=r[i].length;++a){o.s.r>i&&(o.s.r=i),o.s.c>a&&(o.s.c=a),o.e.r<i&&(o.e.r=i),o.e.c<a&&(o.e.c=a);var f={v:r[i][a]};if(null!=f.v){var c=XLSX.utils.encode_cell({c:a,r:i});"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=(t=f.v,void 0&&(t+=1462),(Date.parse(t)-new Date(Date.UTC(1899,11,30)))/864e5)):f.t="s",n[c]=f}}return o.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(o)),n}function a(r){for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=255&r.charCodeAt(n);return e}function f(){if(!(this instanceof f))return new f;this.SheetNames=[],this.Sheets={}}return function(){var r=function(){for(var r=Array.from(document.querySelectorAll("#div2 table tr")),e=Array.from(r[0].querySelectorAll("td")).map((function(r){return r.innerText.trim()})),t=[],n=1;n<r.length;n++){var o=Array.from(r[n].querySelectorAll("td")).map((function(r){var e=0!=r.innerText.trim().length&&r.innerText.trim(),t=null!==r.querySelector("a")&&r.querySelector("a").href,n=null!==r.querySelector("img")&&!!/a1455014|a1455065/.test(r.querySelector("img").src)&&r.querySelector("img").src.split("/").slice(-1)[0],o=!1;return"0"===e&&(o=0),"a1455014.svg"===n?o=100:"a1455014_red.svg"===n?o=90:"a1455014_green.svg"===n?o=80:"a1455065.svg"===n&&(o=70),{text:"0"!==e&&e,href:!1===o&&t,score:o}}));t.push(o)}var i=[];i.push(e);for(var a=0,f=t;a<f.length;a++){var c=f[a];i.push(c.map((function(r){var e=Object.keys(r).find((function(e){return!1!==r[e]}));return r[e]})))}return i.filter((function(r){return-1==r.indexOf(void 0)}))}(),e=document.querySelector("h3").innerText.trim()+".xlsx",t="grade",n=new f,o=new i(r);n.SheetNames.push(t),n.Sheets.grade=o;var c=XLSX.write(n,{bookType:"xlsx",type:"binary"});window.downloadXLSX=function(){var r=document.createElement("a");r.download=e;var t=new Blob([a(c)],{type:"application/octet-stream"});r.href=URL.createObjectURL(t),r.click()}}}));
